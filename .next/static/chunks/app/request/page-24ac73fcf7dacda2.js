(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[968],{733:function(e,s,t){Promise.resolve().then(t.bind(t,1438)),Promise.resolve().then(t.t.bind(t,2972,23))},1438:function(e,s,t){"use strict";t.d(s,{RequestSubmissionForm:function(){return v}});var r=t(7437),a=t(2265),i=t(9376),c=t(9501),l=t(3590),n=t(7119),d=t(2869),o=t(8223),m=t(6815),u=t(2204),x=t(3146),h=t(492),p=t(2934);function j(e){let{trackingNumber:s,onComplete:t}=e,[i,c]=(0,a.useState)(!0),[l,n]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{setTimeout(()=>n(!0),100);let e=setTimeout(()=>{c(!1),null==t||t()},5e3);return()=>clearTimeout(e)},[t]),i)?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"text-center space-y-4 transition-all duration-500 ".concat(l?"opacity-100 scale-100":"opacity-0 scale-95"),children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"rounded-full bg-primary p-6 transition-all duration-500 ".concat(l?"scale-100 rotate-0":"scale-0 rotate-180"),children:(0,r.jsx)(p.Z,{className:"h-16 w-16 text-primary-foreground"})})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold",children:"提交成功！"}),s&&(0,r.jsxs)("p",{className:"text-lg text-muted-foreground",children:["追蹤編號：",(0,r.jsx)("span",{className:"font-mono font-semibold",children:s})]}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"我們會在 3 個工作日內聯絡您"})]})]})}):null}let f=n.Ry({requesterName:n.Z_().min(1,"請輸入您的稱呼"),requesterPhone:n.Z_().min(1,"請輸入聯絡電話").regex(/^(\+?852[-.\s]?)?[2-9]\d{7}$/,"請輸入有效的香港電話號碼（8位數字）"),requesterAge:n.Km(["12-24","25-37","38-50","51-63","64-76","76或以上"],{required_error:"請選擇年齡範圍"}),requesterDistrict:n.Km(["九龍","港島","新界","離島"],{required_error:"請選擇居住地區"}),description:n.Z_().min(20,"請詳細描述您的需求（至少20個字）"),fields:n.IX(n.Km(["生活助手","社區拍檔","街坊樹窿"])).min(1,"請至少選擇一個幫助範疇"),appreciation:n.Z_().optional()}),N=["生活助手","社區拍檔","街坊樹窿"],g=["12-24","25-37","38-50","51-63","64-76","76或以上"],b=["九龍","港島","新界","離島"];function v(){let e=(0,i.useRouter)(),[s,t]=(0,a.useState)(""),[n,p]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),[q,_]=(0,a.useState)(""),{register:k,handleSubmit:w,watch:S,setValue:F,formState:{errors:P}}=(0,c.cI)({resolver:(0,l.F)(f),defaultValues:{fields:[]}}),A=S("fields")||[];S("requesterAge"),S("requesterDistrict");let C=e=>{let s=S("fields")||[];F("fields",s.includes(e)?s.filter(s=>s!==e):[...s,e],{shouldValidate:!0})},D=async e=>{try{t(""),p(!0),y(!1);let s={requester:{name:e.requesterName,phone:e.requesterPhone,age:e.requesterAge,district:e.requesterDistrict},description:e.description,fields:e.fields,appreciation:e.appreciation},r=await fetch("/api/requests/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){let e=await r.json();throw Error(e.error||"提交失敗")}let a=await r.json();_(a.trackingNumber||a.id),y(!0)}catch(e){t(e.message||"提交失敗，請稍後再試")}finally{p(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:w(D),className:"space-y-6",children:[s&&(0,r.jsx)(x.X,{message:s}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"委托者資料"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"requesterName",children:"點樣稱呼你？ *"}),(0,r.jsx)(o.I,{id:"requesterName",...k("requesterName"),placeholder:"您的稱呼",className:"bg-background"}),P.requesterName&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.requesterName.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"requesterPhone",children:"留低你嘅聯絡電話 (可WhatsApp) *"}),(0,r.jsx)(o.I,{id:"requesterPhone",...k("requesterPhone"),placeholder:"例如：91234567",className:"bg-background"}),P.requesterPhone&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.requesterPhone.message}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"請輸入8位數字（例如：91234567）"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{children:"年齡 *"}),(0,r.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"radio",id:"age-".concat(e),value:e,...k("requesterAge"),className:"h-4 w-4"}),(0,r.jsx)(m._,{htmlFor:"age-".concat(e),className:"font-normal cursor-pointer",children:e})]},e))}),P.requesterAge&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.requesterAge.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{children:"居住地區 *"}),(0,r.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"radio",id:"district-".concat(e),value:e,...k("requesterDistrict"),className:"h-4 w-4"}),(0,r.jsx)(m._,{htmlFor:"district-".concat(e),className:"font-normal cursor-pointer",children:e})]},e))}),P.requesterDistrict&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.requesterDistrict.message})]})]}),(0,r.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,r.jsx)("h3",{className:"font-semibold",children:"需求詳情"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{children:"幫助範疇 *"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"請選擇您需要的幫助範疇（可多選）"}),(0,r.jsx)("div",{className:"space-y-2",children:N.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(u.X,{id:"field-".concat(e),checked:A.includes(e),onCheckedChange:()=>C(e)}),(0,r.jsx)(m._,{htmlFor:"field-".concat(e),className:"font-normal cursor-pointer",children:e})]},e))}),P.fields&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.fields.message})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"description",children:"有咩煩惱或者需求啊？ *"}),(0,r.jsx)("textarea",{id:"description",...k("description"),placeholder:"請詳細描述您的需求（至少20個字）...",rows:6,className:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50"}),P.description&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:P.description.message}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"最少需要20個字"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"appreciation",children:"你會用咩形式報答我地嘅義工？例子:心意卡、煮餐飯（選填）"}),(0,r.jsx)(o.I,{id:"appreciation",...k("appreciation"),placeholder:"例如：心意卡、煮餐飯",className:"bg-background"})]})]}),(0,r.jsx)(d.z,{type:"submit",className:"w-full",disabled:n,children:n?(0,r.jsx)(h.g,{size:"sm"}):"提交委托請求"})]}),v&&(0,r.jsx)(j,{trackingNumber:q,onComplete:()=>{e.push("/"),e.refresh()}})]})}}},function(e){e.O(0,[137,972,286,287,854,971,117,744],function(){return e(e.s=733)}),_N_E=e.O()}]);