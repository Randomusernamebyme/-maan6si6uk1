(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{823:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,3158)),Promise.resolve().then(r.bind(r,2096)),Promise.resolve().then(r.t.bind(r,911,23))},3158:function(e,t,r){"use strict";r.d(t,{Header:function(){return w}});var a=r(7437),s=r(7648),n=r(287),o=r(2869),i=r(2265),d=r(8119),l=r(407),c=r(401),u=r(519),m=r(4508);let f=d.fC,h=d.xz;d.ZA,d.Uv,d.Tr,d.Ee,i.forwardRef((e,t)=>{let{className:r,inset:s,children:n,...o}=e;return(0,a.jsxs)(d.fF,{ref:t,className:(0,m.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",r),...o,children:[n,(0,a.jsx)(l.Z,{className:"ml-auto"})]})}).displayName=d.fF.displayName,i.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(d.tu,{ref:t,className:(0,m.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...s})}).displayName=d.tu.displayName;let x=i.forwardRef((e,t)=>{let{className:r,sideOffset:s=4,...n}=e;return(0,a.jsx)(d.Uv,{children:(0,a.jsx)(d.VY,{ref:t,sideOffset:s,className:(0,m.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...n})})});x.displayName=d.VY.displayName;let p=i.forwardRef((e,t)=>{let{className:r,inset:s,...n}=e;return(0,a.jsx)(d.ck,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",r),...n})});p.displayName=d.ck.displayName,i.forwardRef((e,t)=>{let{className:r,children:s,checked:n,...o}=e;return(0,a.jsxs)(d.oC,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:n,...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(d.wU,{children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})})}),s]})}).displayName=d.oC.displayName,i.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(d.Rk,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(d.wU,{children:(0,a.jsx)(u.Z,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=d.Rk.displayName,i.forwardRef((e,t)=>{let{className:r,inset:s,...n}=e;return(0,a.jsx)(d.__,{ref:t,className:(0,m.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",r),...n})}).displayName=d.__.displayName,i.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(d.Z0,{ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=d.Z0.displayName;var g=r(4938),v=r(2369),b=r(7692);function w(){let{user:e,logout:t,loading:r}=(0,n.a)(),i=async()=>{try{await t()}catch(e){console.error("登出失敗:",e)}};return(0,a.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-16 items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)(s.default,{href:"/",className:"flex items-center space-x-2",children:(0,a.jsx)("span",{className:"text-xl font-bold",children:"堅城萬事屋"})}),(0,a.jsxs)("nav",{className:"hidden md:flex items-center gap-4",children:[(0,a.jsxs)(s.default,{href:"/",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 inline mr-1"}),"首頁"]}),e&&(0,a.jsxs)(a.Fragment,{children:["volunteer"===e.role&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.default,{href:"/volunteer/dashboard",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"看板"}),(0,a.jsx)(s.default,{href:"/volunteer/applications",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"我的報名"}),(0,a.jsx)(s.default,{href:"/volunteer/profile",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"個人資料"})]}),"admin"===e.role&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.default,{href:"/admin",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"管理後台"}),(0,a.jsx)(s.default,{href:"/admin/requests",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"委托管理"}),(0,a.jsx)(s.default,{href:"/admin/volunteers",className:"text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60",children:"義工管理"})]})]})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:r?(0,a.jsx)("div",{className:"h-8 w-8 animate-pulse rounded-full bg-muted"}):e?(0,a.jsxs)(f,{children:[(0,a.jsx)(h,{asChild:!0,children:(0,a.jsxs)(o.z,{variant:"ghost",className:"flex items-center gap-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e.displayName}),(0,a.jsxs)("span",{className:"hidden sm:inline text-muted-foreground",children:["(","admin"===e.role?"管理員":"義工",")"]})]})}),(0,a.jsxs)(x,{align:"end",children:[(0,a.jsx)(p,{asChild:!0,children:(0,a.jsxs)(s.default,{href:"admin"===e.role?"/admin":"/volunteer/profile",className:"flex items-center",children:[(0,a.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"個人資料"]})}),(0,a.jsxs)(p,{onClick:i,children:[(0,a.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"登出"]})]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.z,{asChild:!0,variant:"ghost",size:"sm",children:(0,a.jsx)(s.default,{href:"/login",children:"登入"})}),(0,a.jsx)(o.z,{asChild:!0,size:"sm",children:(0,a.jsx)(s.default,{href:"/register",children:"註冊"})})]})})]})})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),s=r(2265),n=r(7053),o=r(535),i=r(4508);let d=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90 hover:text-primary-foreground",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:l=!1,...c}=e,u=l?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:s,size:o,className:r})),ref:t,...c})});l.displayName="Button"},2096:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return l},a:function(){return c}});var a=r(7437),s=r(2265),n=r(3301),o=r(4257),i=r(5978);let d=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),[m,f]=(0,s.useState)(!0),h=async e=>{try{let t=await (0,i.QT)((0,i.JU)(o.db,"users",e));if(t.exists()){let e=t.data();return{...e,createdAt:e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),updatedAt:e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt)}}return null}catch(e){return console.error("Error fetching user data:",e),null}};(0,s.useEffect)(()=>{let e=(0,n.Aj)(o.I,async e=>{l(e),e?u(await h(e.uid)):u(null),f(!1)});return()=>e()},[]);let x=async(e,t)=>{try{let r=await (0,n.e5)(o.I,e,t),a=await h(r.user.uid);u(a)}catch(e){throw Error(e.message||"登入失敗")}},p=async(e,t,r)=>{try{let a=await (0,n.Xb)(o.I,e,t),s={uid:a.user.uid,email:e,role:"volunteer",displayName:r.displayName||"",phone:r.phone||"",age:r.age||"",fields:r.fields||[],skills:r.skills||[],availability:r.availability||[],targetAudience:r.targetAudience||[],goals:r.goals,status:"pending",completedTasks:0,createdAt:new Date,updatedAt:new Date};await (0,i.pl)((0,i.JU)(o.db,"users",a.user.uid),{...s,createdAt:new Date,updatedAt:new Date}),a.user&&!a.user.emailVerified&&await (0,n.w$)(a.user),u(s)}catch(e){throw Error(e.message||"註冊失敗")}},g=async()=>{try{await (0,n.w7)(o.I),u(null)}catch(e){throw Error(e.message||"登出失敗")}},v=async e=>{try{await (0,n.LS)(o.I,e)}catch(e){throw Error(e.message||"發送密碼重置郵件失敗")}},b=async(e,t)=>{try{if(!r||!r.email)throw Error("請先登入");let a=n.w9.credential(r.email,e);await (0,n.aF)(r,a),await (0,n.gQ)(r,t)}catch(e){throw Error(e.message||"修改密碼失敗")}};return(0,a.jsx)(d.Provider,{value:{user:c,firebaseUser:r,loading:m,login:x,register:p,logout:g,sendPasswordReset:v,changePassword:b},children:t})}function c(){let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4257:function(e,t,r){"use strict";let a;r.d(t,{I:function(){return i},db:function(){return d}});var s=r(738),n=r(3301),o=r(5978);a=0===(0,s.C6)().length?(0,s.ZF)({apiKey:"AIzaSyCRZrcO60pVOmgG2PPE5j-OLAKnsyNQk6A",authDomain:"maan6si6uk1.firebaseapp.com",projectId:"maan6si6uk1",storageBucket:"maan6si6uk1.firebasestorage.app",messagingSenderId:"349293937280",appId:"1:349293937280:web:ca2f091d1107bae7e09c65",measurementId:"G-4LWCWNPHB2"}):(0,s.C6)()[0];let i=(0,n.v0)(a),d=(0,o.ad)(a)},287:function(e,t,r){"use strict";r.d(t,{a:function(){return a.a}});var a=r(2096)},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},7960:function(){}},function(e){e.O(0,[944,358,139,137,943,972,286,142,600,696,140,971,117,744],function(){return e(e.s=823)}),_N_E=e.O()}]);